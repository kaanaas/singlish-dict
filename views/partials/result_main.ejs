<div class="result" id="result" style=<%= showStyle %>>
    <div class="word">
        <div class="word-box">
            <h2><%= word.word %>
                <span class="variant-tag"><%= variant %></span>
            </h2>
            <p><%= word.phonetics %></p>
        </div>
        <% if(!word.hasOwnProperty("origin")){ %>
            <div class="ortho-box">
                <p><i>origins unknown</i></p>
            </div>
        <% } else { %>
        <div class="ety-container">
            <!-- main container -->
            <div class="ortho-container" id="ortho-container<%= variant %>" name="show">
                <p class="ortho-origin">→</p>
                <% for(let i = 0; i < word.origin.length; i++) { %>
                    <% if(i != 0) { %>
                        <h2>+</h2>
                    <% } %>
                    <div class="ortho-box">
                        <% const langName = word.origin[i].lang.toLowerCase().charAt(0).toUpperCase() + word.origin[i].lang.toLowerCase().slice(1); %>
                        <% if(i == 0 || word.origin[i].lang.toLowerCase() != word.origin[i-1].lang.toLowerCase()){ %>
                            <p class="ortho-origin small-caps"><%= langName %>:</p>
                        <% } %>
                        <% if(chineseLangs.includes(word.origin[i].lang.toLowerCase())){ %>
                            <!-- Chinese languages -->
                            <div name="chinese-chars">
                                <h3 class="chinese-chars" name="show" title="Click for Traditional" style="display: block; visibility: visible; z-index: 2;" onclick="swapChinese(this)">
                                    <%- formatDyno(word.origin[i].simplified) %></h3>
                                <h3 class="chinese-chars" name="hide" title="Click for Simplified" style="display: none; visibility: hidden; z-index: -1;" onclick="swapChinese(this)">
                                    <%- formatDyno(word.origin[i].traditional) %></h3>
                            </div>
                            <div class="roman-flex">
                                <% if(word.origin[i].romanization == undefined || word.origin[i].romanization == ""){ %>
                                    <% if(word.origin[i].lang.toLowerCase().includes("chinese")){ %>
                                        <p class="romanization">pinyin:</p>
                                    <% } else if(word.origin[i].lang.toLowerCase().includes("hokkien") || word.origin[i].lang.toLowerCase().includes("min nan")){ %>
                                        <p class="romanization">poj:</p>
                                    <% } else if(word.origin[i].lang.toLowerCase().includes("cantonese")){ %>
                                        <p class="romanization">jyutping:</p>
                                    <% } else if(word.origin[i].lang.toLowerCase().includes("teochew")){ %>
                                        <p class="romanization">peng'im:</p>
                                    <% } else if(word.origin[i].lang.toLowerCase().includes("mandarin")){ %>
                                        <p class="romanization">pinyin:</p>
                                    <% } %>
                                <% } else { %>
                                    <p class="romanization"><%= word.origin[i].romanization.toLowerCase() %>:</p>
                                <% } %>
                                <p class="ortho-roman"><%= word.origin[i].roman.toLowerCase() %></p>
                            </div>
                        <% } else if(word.origin[i].simplified != undefined && word.origin[i].simplified != "") { %>
                            <!-- Other alt-script languages -->
                            <% if(word.origin[i].simplified != ""){ %>
                            <h3 class="non-bold"><%- formatDyno(word.origin[i].simplified) %></h3>
                            <div class="roman-flex">
                                <% if(word.origin[i].romanization && word.origin[i].romanization != "") { %>
                                    <p class="romanization"><%= word.origin[i].romanization %>:</p>
                                <% } %>
                                <p class="ortho-roman"><%= word.origin[i].roman.toLowerCase() %></p>
                            </div>
                            <% } %>
                        <% } else if(langName.toLowerCase() == "singlish") { %>
                            <h4><a href="./?q=<%= word.origin[i].roman.toLowerCase() %>"><%= word.origin[i].roman.toLowerCase() %></a></h4>
                        <% } else { %>
                            <h4><%- formatDyno(word.origin[i].roman) %></h4>
                        <% } %>
                    </div>
                <% } %>
            </div>

            <!-- extended container -->
            <div class="ortho-container ortho-container-ext" id="ext-container<%= variant %>" name="hide" style = "display: none; visibility: hidden">
                <% for(let i = 0; i < word.origin.length; i++) { %>
                    <div class="origin-container">
                        <% if(i != 0) { %>
                            <h2 class="ortho-origin" style="font-style: normal;">+ </h2>
                        <% } else { %>
                            <p class="ortho-origin">from</p>
                        <% } %>
                        <div class="ortho-box">
                            <div class="ortho-box-ext">
                                <% const langName=word.origin[i].lang.toLowerCase(); %>
                                <div class="lang-romz-wrapper">
                                    <p class="ortho-origin-ext small-caps"><%= langName %></p>
                                    
                                    <% if(chineseLangs.includes(word.origin[i].lang.toLowerCase())){ %>
                                        <% if(word.origin[i].romanization == undefined || word.origin[i].romanization == ""){ %>
                                            <% if(word.origin[i].lang.toLowerCase().includes("chinese")){ %>
                                                <p class="romanization">(pinyin)</p>
                                            <% } else if(word.origin[i].lang.toLowerCase().includes("hokkien") || word.origin[i].lang.toLowerCase().includes("min nan")){ %>
                                                <p class="romanization">(poj)</p>
                                            <% } else if(word.origin[i].lang.toLowerCase().includes("cantonese")){ %>
                                                <p class="romanization">(jyutping)</p>
                                            <% } else if(word.origin[i].lang.toLowerCase().includes("teochew")){ %>
                                                <p class="romanization">(peng'im)</p>
                                            <% } else if(word.origin[i].lang.toLowerCase().includes("mandarin")){ %>
                                                <p class="romanization">(pinyin)</p>
                                            <% } %>
                                        <% } else { %>
                                            <p class="romanization">(<%= word.origin[i].romanization.toLowerCase() %>)</p>
                                        <% } %>
                                    <% } %>
                                </div>

                                <% if(chineseLangs.includes(word.origin[i].lang.toLowerCase())){ %>
                                    <!-- Chinese languages -->
                                    <div class="chinese-wrapper-ext">
                                        <div name="chinese-chars">
                                            <h3 class="chinese-chars-ext" name="show" title="Click for Traditional" style="display: block; visibility: visible; z-index: 2;" onclick="swapChinese(this)">
                                                <%- formatDyno(word.origin[i].simplified) %></h3>
                                            <h3 class="chinese-chars-ext" name="hide" title="Click for Simplified" style="display: none; visibility: hidden; z-index: -1;" onclick="swapChinese(this)">
                                                <%- formatDyno(word.origin[i].traditional) %></h3>
                                        </div>
                                        <div class="roman-flex-ext">
                                            
                                            <p class="ortho-roman"><%= word.origin[i].roman.toLowerCase() %></p>
                                        </div>
                                    </div>
                                <% } else if(word.origin[i].simplified != undefined && word.origin[i].simplified != "") { %>
                                    <!-- Other alt-script languages -->
                                    <% if(word.origin[i].simplified != ""){ %>
                                    <div class="chinese-wrapper-ext">
                                        <h3 class="non-bold"><%- formatDyno(word.origin[i].simplified) %></h3>
                                        <div class="roman-flex">
                                            <p class="ortho-roman"><%= word.origin[i].roman.toLowerCase() %></p>
                                        </div>
                                    </div>
                                    <% } %>
                                <% } else if(langName.toLowerCase() == "singlish") { %>
                                    <h4><a href="./?q=<%= word.origin[i].roman.toLowerCase() %>"><%= word.origin[i].roman %></a></h4>
                                <% } else { %>
                                    <h4 style="margin: 0;"><%- formatDyno(word.origin[i].roman) %></h4>
                                <% } %>

                                <div class="ortho-lit-div">
                                    <p class="lit"><%- formatDyno(word.origin[i].lit) %></p>
                                </div>
                            </div>
                        </div>

                        <!-- ety paths -->
                        <% if(word.origin[i].etyPath){ %>
                            <% for(let j = 0; j < word.origin[i].etyPath.length; j++){ %>
                                <% if(word.origin[i].etyType != undefined && j != 0){ %>
                                    <% if(word.origin[i].etyType[j-1] == "" || word.origin[i].etyType[j-1] == "-"){ %>
                                    <p class="ortho-origin ortho-arrow">←</p>
                                    <% } else if(word.origin[i].etyType[j-1] == "tx" || word.origin[i].etyType[j-1] == "c"){ %>
                                    <p class="ortho-origin ortho-arrow">↻</p>
                                    <% } else { %>
                                    <p class="ortho-origin ortho-arrow"><%= word.origin[i].etyType[j-1] %></p>
                                    <% } %>
                                <% } else { %>
                                    <p class="ortho-origin ortho-arrow">←</p>
                                <% } %>
                                <div class="ortho-box">
                                <div class="ortho-box-ext">
                                    <!-- const langName = word.origin[i].etyPath[j].toLowerCase().charAt(0).toUpperCase() + word.origin[i].etyPath[j].toLowerCase().slice(1); %> -->
                                    <% const langName = word.origin[i].etyPath[j].toLowerCase(); %>
                                    
                                    <div class="lang-romz-wrapper">
                                        <p class="ortho-origin-ext small-caps"><%= langName %></p>
                                        <% if(word.origin[i].etyPath[j] && chineseLangs.includes(word.origin[i].etyPath[j].toLowerCase())){ %>
                                            <% if(word.origin[i].etyScheme == false || word.origin[i].etyScheme == undefined || word.origin[i].etyScheme == undefined || word.origin[i].etyScheme[j] == undefined || word.origin[i].etyScheme[j] == ""){ %>
                                                <% if(word.origin[i].etyPath[j].includes("chinese")){ %>
                                                    <p class="romanization">(pinyin)</p>
                                                <% } else if(word.origin[i].etyPath[j].includes("hokkien") || word.origin[i].etyPath[j].includes("min nan")){ %>
                                                    <p class="romanization">(poj)</p>
                                                <% } else if(word.origin[i].etyPath[j].includes("cantonese")){ %>
                                                    <p class="romanization">(jyutping)</p>
                                                <% } else if(word.origin[i].etyPath[j].includes("teochew")){ %>
                                                    <p class="romanization">(peng'im)</p>
                                                <% } else if(word.origin[i].etyPath[j].includes("mandarin")){ %>
                                                    <p class="romanization">(pinyin)</p>
                                                <% } %>
                                            <% } else { %>
                                                <p class="romanization">(<%= word.origin[i].etyScheme[j].toLowerCase() %>)</p>
                                            <% } %>
                                        <% } %>
                                    </div>

                                    <% if(word.origin[i].etyPath[j] && chineseLangs.includes(word.origin[i].etyPath[j].toLowerCase())){ %>
                                    <!-- Chinese languages -->
                                    <div class="chinese-wrapper-ext">
                                        <div name="chinese-chars">
                                            <h3 class="chinese-chars-ext" name="show" title="Click for Traditional" style="display: block; visibility: visible; z-index: 2;" onclick="swapChinese(this)">
                                                <%- formatDyno(word.origin[i].etyScript[j]) %></h3>
                                            <h3 class="chinese-chars-ext" name="hide" title="Click for Simplified" style="display: none; visibility: hidden; z-index: -1;" onclick="swapChinese(this)">
                                                <%- formatDyno(word.origin[i].etyTrad[j]) %></h3>
                                        </div>
                                        <div class="roman-flex-ext">
                                            
                                            <p class="ortho-roman"><%= word.origin[i].etyRoman[j].toLowerCase().replace(/,/g, ", ") %></p>
                                        </div>
                                    </div>
                                    <% } else if(word.origin[i].etyScript && word.origin[i].etyScript[j] != undefined && word.origin[i].etyScript[j] != "") { %>
                                        <!-- Other alt-script languages -->
                                        <% if(word.origin[i].etyScript[j] != ""){ %>
                                        <div class="chinese-wrapper-ext">
                                            <h3 class="non-bold"><%- formatDyno(word.origin[i].etyScript[j]) %></h3>
                                            <div class="roman-flex">
                                                <p class="ortho-roman">
                                                <% if(word.origin[i].etyScript[j] !="" ){ %>
                                                    <%= word.origin[i].etyRoman[j].toLowerCase().replace(/,/g, ", ") %>
                                                <% } %>
                                                </p>
                                            </div>
                                        </div>
                                        <% } %>
                                    <% } else if(langName.toLowerCase() == "singlish") { %>
                                        <h4><a href="./?q=<%= word.origin[i].etyRoman[j].toLowerCase() %>"><%= word.origin[i].etyRoman[j] %></a></h4>
                                    <% } else { %>
                                        <h4 style="margin: 0;"><%- formatDyno(word.origin[i].etyRoman[j].replace(/,/g, ", ")) %></h4>
                                    <% } %>
                                    
                                    <% if(word.origin[i].etyLit[j]){ %>
                                        <p class="lit"><%- formatDyno(word.origin[i].etyLit[j].replace(/,/g, ", ")) %></p>
                                    <% } %>
                                </div>
                                </div>
                            <% } %>
                        <% } %>
                    </div>
                <% } %>
            </div>
        </div>

        <!-- ety notes -->
        <% if(word.hasOwnProperty("etyNotes")){ %>
            <% if(word.etyNotes.length> 0){ %>
                <div class="details ety-notes-div" id="ety-notes<%= variant %>" style = "display: none; visibility: hidden">
                    <h3 class="ety-notes-leader">etymology notes</h3>
                    <p class="text cn-fallback"><%- formatDyno(word.etyNotes) %></p>
                </div>
            <% } %>
        <% } %>
        <% } %>
    </div>
    <div class="more-info-wrapper">
        <div class="more-info-div">
            <div class="ttip-ety">
                <span class="expand-text" id="expand-text<%= variant %>">details</span>
                <i class="fa-solid fa-circle-down ety-extend" tabindex="0" onclick="swapEty('<%= variant %>')"
                    id="ety-btn<%= variant %>"></i>
                <span class="tooltip-text" id="ety-tooltip<%= variant %>">Detailed etymology</span>
            </div>
        </div>
        <hr>
    </div>
</div>

<script>
    function swapEty(v){
        const etyBtn = document.getElementById(`ety-btn${v}`);
        const etyTtip = document.getElementById(`ety-tooltip${v}`);
        const etyExpandText = document.getElementById(`expand-text${v}`);
        const orthoContainer = document.getElementById(`ortho-container${v}`);
        const extContainer = document.getElementById(`ext-container${v}`);
        const etyNotes = document.getElementById(`ety-notes${v}`);
        etyBtn.blur();
        if(orthoContainer.name == "hide"){
            orthoContainer.style = "display: flex; visibility: visible";
            extContainer.style = "display: none; visibility: hidden";
            orthoContainer.name = "show";
            extContainer.name = "hide";
            if(etyNotes) etyNotes.style = "display: none; visibility: hidden";
            etyTtip.innerHTML = "Detailed etymology";
            etyBtn.style = "transform: rotate(0)";
            // etyExpandText.style = "color:#6d946d";
        }
        else{
            orthoContainer.style = "display: none; visibility: hidden";
            extContainer.style = "display: flex; visibility: visible";
            orthoContainer.name = "hide";
            extContainer.name = "show";
            if (etyNotes) etyNotes.style = "display: block; visibility: visible";
            etyTtip.innerHTML = "Collapse details";
            etyBtn.style = "transform: rotate(0.5turn)";
            // etyExpandText.style = "color:#951818";
        }
    }

    function swapChinese(el){
        const charDiv = el.parentElement;
        const trad = charDiv.children[0];
        const simp = charDiv.children[1];

        if(trad.name == "hide"){
            trad.style = "display: block; visibility: visible; z-index: 2; transition: 1s";
            simp.style = "display: none; visibility: hidden; z-index: -1; transition: 1s";
            trad.name = "show";
            simp.name = "hide";
        }
        else {
            simp.style = "display: block; visibility: visible; z-index: 2; transition: 1s";
            trad.style = "display: none; visibility: hidden; z-index: -1; transition: 1s";
            simp.name = "show";
            trad.name = "hide";
        }
    }

    
</script>
